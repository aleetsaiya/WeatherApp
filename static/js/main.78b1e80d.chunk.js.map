{"version":3,"sources":["image/refresh.jpg","image/sunny.gif","image/ranny.gif","component/WeatherApp.jsx","App.js","index.js"],"names":["WeatherApp","authorization","useState","locationName","temp","humd","chanceOfRain","description","maxT","minT","hour","min","currentWeather","setCurrentWeather","useEffect","fetchData","a","console","log","Promise","all","fetchCurrentWeather","fetchWeatherPrediction","weatherPrediction","url","axios","get","then","respose","target","data","records","location","find","parseFloat","weatherElement","e","elementName","elementValue","time","obsTime","split","response","obj","parameter","parameterName","className","src","includes","ranny","sunny","alt","refresh","onClick","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.78b1e80d.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/refresh.9c0da300.jpg\";","export default __webpack_public_path__ + \"static/media/sunny.469a1d1b.gif\";","export default __webpack_public_path__ + \"static/media/ranny.3514cb41.gif\";","import axios from 'axios';\r\nimport React, { useState, useEffect } from 'react';\r\nimport './WeatherApp.css'\r\nimport refresh from '../image/refresh.jpg';\r\nimport sunny from '../image/sunny.gif';\r\nimport ranny from '../image/ranny.gif';\r\n\r\nconst WeatherApp = () => {\r\n    const authorization = \"CWB-52F9DCE3-BDF3-49E6-81A5-32A4AFDC7460\";\r\n    const [currentWeather, setCurrentWeather] = useState({\r\n        locationName: \"NaN\",\r\n        temp: \"0\", // 溫度\r\n        humd: \"0\", // 相對濕度\r\n        chanceOfRain: \"0\", //降雨機率\r\n        description: \"NaN\", // 天氣狀態\r\n        maxT: \"\", // 最高溫度\r\n        minT: \"\", // 最低溫度\r\n        hour: \"00\", // 最後觀測時間 ( 小時 )\r\n        min: \"00\" // 最後觀測時間 ( 分鐘 )\r\n    });\r\n\r\n    useEffect(() => {\r\n        fetchData();\r\n    }, []);\r\n\r\n    const fetchData = async () => {\r\n        console.log('fetch');\r\n        const [currentWeather, weatherPrediction] = await Promise.all([\r\n            fetchCurrentWeather(),\r\n            fetchWeatherPrediction()\r\n        ]);\r\n        if (currentWeather.temp === \"NaN\") {\r\n            currentWeather.temp = `${weatherPrediction.minT}~${weatherPrediction.maxT}`;\r\n        }\r\n        setCurrentWeather({\r\n            ...currentWeather,\r\n            ...weatherPrediction\r\n        });\r\n    };\r\n\r\n    const fetchCurrentWeather = () => {\r\n        const url = `https://opendata.cwb.gov.tw/api/v1/rest/datastore/O-A0003-001?Authorization=${authorization}`;\r\n        return axios.get(url)\r\n            .then(respose => {\r\n                const locationName = \"淡水\";\r\n                const target = respose.data.records.location.find(data => data.locationName === locationName);\r\n                let temp = parseFloat(target.weatherElement.find(e => e.elementName === \"TEMP\").elementValue);\r\n                let humd = parseFloat(target.weatherElement.find(e => e.elementName === \"HUMD\").elementValue)*100;\r\n                const time = target.time.obsTime.split(' ')[1];\r\n                const hour = time.split(':')[0];\r\n                const min = time.split(':')[1];\r\n                temp = temp < -50 ? \"NaN\" : temp;\r\n                humd = humd < -50 ? \"NaN\" : humd;\r\n                return {\r\n                    locationName,\r\n                    temp,\r\n                    humd,\r\n                    hour,\r\n                    min\r\n                };\r\n            });\r\n    };\r\n\r\n    const fetchWeatherPrediction = () => {\r\n        const url = `https://opendata.cwb.gov.tw/api/v1/rest/datastore/F-C0032-001?Authorization=${authorization}`;\r\n        return axios.get(url)\r\n            .then(response => {\r\n                const locationName = \"新北市\";\r\n                const data = response.data.records.location.find(obj => obj.locationName === locationName);\r\n                const description = data.weatherElement.find(e => e.elementName === 'Wx').time[0].parameter.parameterName;\r\n                const chanceOfRain = data.weatherElement.find(e => e.elementName === 'PoP').time[0].parameter.parameterName;\r\n                const maxT = data.weatherElement.find(e => e.elementName === 'MaxT').time[0].parameter.parameterName;\r\n                const minT = data.weatherElement.find(e => e.elementName === 'MinT').time[0].parameter.parameterName;\r\n                return {\r\n                    description,\r\n                    chanceOfRain,\r\n                    maxT,\r\n                    minT\r\n                };\r\n            });\r\n    }\r\n\r\n    const isRanny = () => {\r\n        const description = currentWeather.description;\r\n        if (description.includes('雨') || description.includes('陰')) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    return (\r\n        <div className=\"card\">\r\n            <h3>{currentWeather.locationName}</h3>\r\n            <div>{currentWeather.description}</div>\r\n            <div className=\"main\">\r\n                <div className=\"temp\">{currentWeather.temp}<span>°C</span></div>\r\n                <img src={isRanny ? ranny : sunny} alt=\"weather icon\" className=\"weatherIcon\"/>\r\n            </div>\r\n            <div className=\"weatherElement\">\r\n                <div>相對溼度: {currentWeather.humd}%</div>\r\n                <div>降雨機率: {currentWeather.chanceOfRain}%</div>\r\n            </div>\r\n            <div className=\"refresh\">\r\n                <span>最後觀測時間: {currentWeather.hour}:{currentWeather.min}</span>\r\n                <img src={refresh} alt=\"refresh\" className=\"refreshIcon\"  onClick={() => {\r\n                    fetchData();\r\n                }}/>\r\n            </div>   \r\n        </div>\r\n    );\r\n}\r\n\r\nexport default WeatherApp; ","import './App.css';\nimport WeatherApp from './component/WeatherApp';\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <WeatherApp/>\n    </div>\n  );\n}\n\nexport default App;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);"],"sourceRoot":""}